# Stress config targeting the overlap inefficiency pattern documented in docs/overlap.
RunOptions:
  world_size: 4
  num_batches: 24
  sharding_type: row_wise
  compute_kernel: fused_uvm_caching
  profile_dir: "./trace_overlap_ineff"
  name: "sparse_data_dist_overlap_ineff"
  export_stacks: true

PipelineConfig:
  pipeline: "sparse"

ModelSelectionConfig:
  model_name: "test_sparse_nn"
  batch_size: 32768
  num_float_features: 64
  feature_pooling_avg: 4
  pin_memory: false
  long_kjt_indices: true
  long_kjt_offsets: true
  long_kjt_lengths: true

EmbeddingTablesConfig:
  num_unweighted_features: 480
  num_weighted_features: 240
  embedding_feature_dim: 64
  additional_tables:
    - - name: hot_row_table_0
        embedding_dim: 128
        num_embeddings: 2_000_000
        feature_names: ["hot_row_0"]
      - name: hot_row_table_1
        embedding_dim: 128
        num_embeddings: 2_000_000
        feature_names: ["hot_row_1"]
    - - name: weighted_hot_row_table_0
        embedding_dim: 64
        num_embeddings: 1_500_000
        feature_names: ["weighted_hot_row_0"]
      - name: weighted_hot_row_table_1
        embedding_dim: 64
        num_embeddings: 1_500_000
        feature_names: ["weighted_hot_row_1"]
